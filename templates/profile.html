{% extends "layout.html" %}

{% block title %}
profile
{% endblock %}

{% block top %}
<div class="container">
    <h1 class="text-center mt-5">Welcome to LINE LIFF App</h1>
    <div class="text-center mt-3">
        <button id="login" class="btn btn-primary">Login</button>
        <button id="logout" class="btn btn-secondary">Logout</button>
    </div>
    <div id="profileInfo" class="text-center mt-3" style="display:none;">
        <img id="profilePictureUrl" src="" alt="Profile Picture" class="img-thumbnail" width="100">
        <p id="displayName" class="mt-2"></p>
    </div>
</div>
<script>
    async function main() {
        await liff.init({ liffId: "{{ liff_id }}" });
        if (!liff.isLoggedIn()) {
            document.getElementById("login").style.display = "block";
            document.getElementById("logout").style.display = "none";
            document.getElementById("profileInfo").style.display = "none";
        } else {
            document.getElementById("login").style.display = "none";
            document.getElementById("logout").style.display = "block";
            document.getElementById("profileInfo").style.display = "block";
            const profile = await liff.getProfile();
            document.getElementById("profilePictureUrl").src = profile.pictureUrl;
            document.getElementById("displayName").innerText = "Name: " + profile.displayName;
        }
        document.getElementById("login").addEventListener("click", () => {
            liff.login();
        });
        document.getElementById("logout").addEventListener("click", () => {
            liff.logout();
            window.location.reload();
        });
    }
    main();
</script>
{% endblock %}